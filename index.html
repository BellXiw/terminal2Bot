<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ù–∞–π–¥–∏ –ø–∞—Ä—ã</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      margin: 0;
      background: black;
      color: #00fff0;
      font-family: monospace;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .container {
      border: 2px solid #00fff0;
      border-radius: 20px;
      padding: 15px;
      text-align: center;
      width: fit-content;
    }

    h1 {
      font-size: 20px;
      margin-bottom: 10px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(5, 45px);
      gap: 5px;
      justify-content: center;
    }

    .cell {
      width: 45px;
      height: 45px;
      background: black;
      border: 1px solid #00fff0;
      color: #00fff0;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 16px;
      cursor: pointer;
      user-select: none;
    }

    .cell.hidden {
      color: black;
    }

    .slots {
      display: flex;
      justify-content: center;
      margin-top: 10px;
      gap: 10px;
    }

    .slot {
      width: 45px;
      height: 45px;
      border: 1px solid #00fff0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #timer {
      margin-top: 8px;
    }

    #restart {
      margin-top: 8px;
      background: black;
      color: #00fff0;
      border: 1px solid #00fff0;
      padding: 4px 10px;
      cursor: pointer;
    }

    #statusEmoji {
      font-size: 26px;
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üß† –ù–∞–π–¥–∏ –ø–∞—Ä—ã</h1>
    <div class="grid" id="grid"></div>
    <div class="slots">
      <div class="slot" id="slot1"></div>
      <div class="slot" id="slot2"></div>
      <div class="slot" id="slot3"></div>
    </div>
    <div id="timer">‚è≥ 30 —Å–µ–∫</div>
    <button id="restart" onclick="location.reload()">–†–µ—Å—Ç–∞—Ä—Ç</button>
    <div id="statusEmoji"></div>
  </div>

  <script>
    const gridEl = document.getElementById('grid');
    const timerEl = document.getElementById('timer');
    const slots = [document.getElementById('slot1'), document.getElementById('slot2'), document.getElementById('slot3')];
    const statusEmoji = document.getElementById('statusEmoji');

    const size = 5;
    const total = size * size;
    let numbers = [];
    let revealed = Array(total).fill(false);
    let matched = Array(total).fill(false);
    let selected = [];

    let time = 30;
    let tick;

    function generateGrid() {
      const used = new Set();
      const pairs = [];

      while (pairs.length < 3) {
        let n = Math.floor(Math.random() * 20) + 1;
        if (!used.has(n)) {
          used.add(n);
          pairs.push(n, n);
        }
      }

      const remaining = [];
      while (remaining.length < total - 6) {
        let n = Math.floor(Math.random() * 20) + 1;
        if (!used.has(n)) {
          used.add(n);
          remaining.push(n);
        }
      }

      numbers = [...pairs, ...remaining].sort(() => Math.random() - 0.5);
    }

    function renderGrid() {
      gridEl.innerHTML = '';
      for (let i = 0; i < total; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.index = i;
        if (!revealed[i] && !matched[i]) {
          cell.classList.add('hidden');
          cell.textContent = numbers[i];
        } else if (matched[i]) {
          cell.textContent = '';
        } else {
          cell.textContent = numbers[i];
        }
        cell.onclick = () => handleClick(i);
        gridEl.appendChild(cell);
      }
    }

    function handleClick(index) {
      if (revealed[index] || matched[index] || selected.length >= 2) return;
      revealed[index] = true;
      selected.push(index);
      renderGrid();

      if (selected.length === 2) {
        const [i1, i2] = selected;
        if (numbers[i1] === numbers[i2]) {
          matched[i1] = matched[i2] = true;
          setTimeout(() => {
            addToSlot(numbers[i1]);
            selected = [];
            renderGrid();
            checkWin();
          }, 500);
        } else {
          setTimeout(() => {
            revealed[i1] = revealed[i2] = false;
            selected = [];
            renderGrid();
          }, 800);
        }
      }
    }

    function addToSlot(num) {
      for (let slot of slots) {
        if (!slot.textContent) {
          slot.textContent = num;
          return;
        }
      }
    }

    function checkWin() {
      if (slots.every(slot => slot.textContent)) {
        clearInterval(tick);
        statusEmoji.textContent = '‚úÖ';
      }
    }

    function lose() {
      statusEmoji.textContent = '‚ùå';
    }

    function startTimer() {
      tick = setInterval(() => {
        time--;
        timerEl.textContent = `‚è≥ ${time} —Å–µ–∫`;
        if (time <= 0) {
          clearInterval(tick);
          lose();
        }
      }, 1000);
    }

    function init() {
      generateGrid();
      revealed.fill(true);
      renderGrid();

      setTimeout(() => {
        revealed.fill(false);
        renderGrid();
        startTimer();
      }, 5000);
    }

    init();
  </script>
</body>
</html>
